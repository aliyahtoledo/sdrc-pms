{% extends 'sdrc/base.html' %}

{% block style %}
{% endblock %}

{% block content %}
    {% load humanize %}
    {% for p in projects %}
        {% if p.hasTranche == True %}

            <div class="">


                <div class="row">

                    <div class="col-md-12 col-sm-12 col-xs-12">


                        <!-- Closure -->
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>Create Milestones</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                           aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a href="#">Settings 1</a>
                                            </li>
                                            <li><a href="#">Settings 2</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            {% if messages %}
                                <div class="alert alert-danger alert-dismissible fade in" role="alert"
                                     style="height: 50%;">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                            aria-hidden="true">×</span>
                                    </button>
                                    <ul class="messages">
                                        {% for message in messages %}
                                            <li class="{{ message.tags }}">{{ message }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                            <div class="x_content">


                                <!-- Smart Wizard -->

                                <form class="form-horizontal" method="POST" action="">
                                    {% csrf_token %}
                                    {% for entry in projects %}
                                        <div class="row spacer">
                                            <div class="form-group">
                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                       for="first-name">Project
                                                    Name
                                                </label>
                                                <div class="col-md-6 col-sm-6 col-xs-12">
                                                    <input type="text" name="project" value="{{ entry.projectTitle }}"
                                                           required="required" class="form-control col-md-7 col-xs-12"
                                                           readonly/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                       for="first-name">Project
                                                    Date
                                                </label>
                                                <div class="col-md-6 col-sm-6 col-xs-12">
                                                    <input type="text" name="project"
                                                           value="{{ entry.startDate }} - {{ entry.endDate }}"
                                                           required="required" class="form-control col-md-7 col-xs-12"
                                                           readonly/>
                                                </div>
                                            </div>
                                            <input class="form-control col-md-7 col-xs-12" id="startDate"
                                                   type="text" value="{{ entry.startDate }}"
                                                   style="display: none;">
                                            <input class="form-control col-md-7 col-xs-12" id="endDate"
                                                   type="text" value="{{ entry.endDate }}"
                                                   style="display: none;">


                                        </div>
                                    {% endfor %}



                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Milestone
                                                Name<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                                {{ formset.milestoneName }}
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Start
                                                Date<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                                {{ formset.milestonestartDate }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Due
                                                Date<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                                {{ formset.milestoneendDate }}
                                            </div>
                                        </div>

                                    </div>

                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Tranche
                                                Amount<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                                {{ formset.trancheAmount }}
                                            </div>
                                        </div>

                                    </div>

                                 <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Remaining Budget
                                                <span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                {% for p in projects %}
                                                    <input type="number" class="form-control" readonly value="{{ p.projectCost }}">
                                                    {% endfor %}

                                            </div>
                                        </div>

                                    </div>


                                    <div class="row spacer">
                                        <div class="form-group">
                                            <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                                                <button type="submit" style="margin-left: 160px; padding: 8px 25px;"
                                                        class="btn btn-success">Add
                                                    Milestone
                                                </button>

                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <form method="POST">
                                    {% csrf_token %}
                                    {% for entry in projects %}
                                        <input style="display: none" name="dontload" value="1">
                                        <input name="projectID" style="display: none"
                                               value="{{ entry.principalInvestigator_id }}">
                                        <button type="submit" class="btn btn-primary"
                                                style="margin-left: 438px; margin-top: 5px; padding: 8px 25px;">Add
                                            Members
                                        </button>
                                    {% endfor %}
                                </form>
                                <div class="ln_solid"></div>
                                {% if all_formset %}

                                    <table id="datatable" class="table table-striped table-bordered">
                                        <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Milestone Name</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Tranche Amount</th>

                                            <th>Action</th>

                                        </tr>
                                        </thead>
                                        {% for milestone in all_formset %}
                                            <tbody>
                                            <tr>
                                                <td>{{ forloop.counter }}</td>
                                                <td>{{ milestone.milestoneName }}</td>
                                                <td>{{ milestone.milestonestartDate }}</td>
                                                <td>{{ milestone.milestoneendDate }}</td>
                                                <td>{{ milestone.trancheAmount|intcomma }}</td>

                                                <td>
                                                    <button type="button" class="btn btn-primary btn-sm"
                                                            style="margin-left: 15px; margin-right: -30px;"
                                                            data-toggle="modal" data-target="#edit-{{ milestone.pk }}">
                                                        Edit
                                                    </button>
                                                </td>
                                                <td>
                                                    <button type="button" class="btn btn-danger btn-sm"
                                                            style="margin-left: 15px; margin-right: -30px;"
                                                            data-toggle="modal"
                                                            data-target="#delete-{{ milestone.pk }}">
                                                        Delete
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                            <div class="modal fade bs-example-modal-sm-resolution"
                                                 style="width:600px; margin-left: 300px; margin-top: 20px;"
                                                 id="delete-{{ milestone.pk }}" tabindex="-1" role="dialog"
                                                 aria-hidden="true">

                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal"
                                                                aria-label="Close"><span aria-hidden="true">×</span>
                                                        </button>
                                                        <h4 class="modal-title" id="myModalLabel2">Delete Milestone</h4>

                                                    </div>
                                                    <form method="POST">
                                                        {% csrf_token %}
                                                        <div class="modal-body" style="height: 100px;">
                                                            <div class="form-group" style="display: none;">
                                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                       for="first-name">Milestone Name<span
                                                                        class="required"></span>
                                                                </label>
                                                                <div class="col-md-9 col-sm-9 col-xs-12">
                                                                    <input type="text" name="milestoneID"
                                                                           value="{{ milestone.id }}"
                                                                           class="form-control col-md-7 col-xs-12">
                                                                </div>
                                                            </div>
                                                            <div class="form-group" style="display: none;">
                                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                       for="first-name">Milestone Name<span
                                                                        class="required"></span>
                                                                </label>
                                                                <div class="col-md-9 col-sm-9 col-xs-12">
                                                                    <input type="text" name="milestoneUpdate"
                                                                           value="Delete"
                                                                           class="form-control col-md-7 col-xs-12">
                                                                </div>
                                                            </div>

                                                            <div style="font-size: 15px;"> Are you sure you want to
                                                                delete
                                                                the milestone "{{ milestone.milestoneName }}"?
                                                            </div>

                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="submit" class="btn btn-primary">Yes</button>
                                                            <button type="button" class="btn btn-default"
                                                                    data-dismiss="modal">No
                                                            </button>

                                                        </div>

                                                    </form>

                                                </div>
                                            </div>
                                            <div class="modal fade bs-example-modal-sm-resolution"
                                                 style="width:600px; height: auto; margin-left: 300px; margin-top: 20px;"
                                                 id="edit-{{ milestone.pk }}" tabindex="-1" role="dialog"
                                                 aria-hidden="true">

                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal"
                                                                aria-label="Close"><span aria-hidden="true">×</span>
                                                        </button>
                                                        <h4 class="modal-title" id="myModalLabel2">Update Milestone</h4>

                                                    </div>
                                                    <form method="POST">
                                                        {% csrf_token %}
                                                        <div class="modal-body" style="height: 150px;">
                                                            <div class="row form-row spacer">
                                                                <div class="form-group" style="display: none;">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">Milestone Name<span
                                                                            class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="milestoneID"
                                                                               value="{{ milestone.id }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group" style="display: none;">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">Milestone Name<span
                                                                            class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="milestoneUpdate"
                                                                               value="Update"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">Milestone
                                                                        Name<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" style="margin-top: 10px;"
                                                                               name="oldmilestoneName"
                                                                               value="{{ milestone.milestoneName }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">Start
                                                                        Date<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" style="margin-top: 10px;"
                                                                               name="oldmilestonestartDate"
                                                                               value="{{ milestone.milestonestartDate }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">End
                                                                        Date<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="oldmilestoneendDate"
                                                                               style="margin-top: 10px;"
                                                                               value="{{ milestone.milestoneendDate }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">

                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           style="margin-top: 30px;" for="first-name">New
                                                                        Milestone Name
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12"
                                                                         style="margin-top: 30px;">
                                                                        {{ updateform.newmilestoneName }}
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">

                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">New
                                                                        Milestone Start Date
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        {{ updateform.newmilestonestartDate }}
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">New
                                                                        Milestone End Date
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        {{ updateform.newmilestoneendDate }}
                                                                    </div>

                                                                </div>


                                                            </div>
                                                        </div>

                                                        <button type="button" class="btn btn-default"
                                                                data-dismiss="modal"
                                                                style="margin-top: 20px; margin-left: 420px; margin-bottom: 20px;">
                                                            Close
                                                        </button>
                                                        <input type="submit" class="btn btn-primary"
                                                               style="margin-top: 20px; margin-bottom: 20px;">

                                                    </form>

                                                </div>
                                            </div>
                                        {% endfor %}
                                    </table>

                                {% endif %}


                            </div>
                        </div>

                    </div>
                </div>
            </div></div>
        {% else %}
            <div class="">


                <div class="row">

                    <div class="col-md-12 col-sm-12 col-xs-12">


                        <!-- Closure -->
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>Create Milestones</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                           aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a href="#">Settings 1</a>
                                            </li>
                                            <li><a href="#">Settings 2</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            {% if messages %}
                                <div class="alert alert-danger alert-dismissible fade in" role="alert"
                                     style="height: 50%;">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                            aria-hidden="true">×</span>
                                    </button>
                                    <ul class="messages">
                                        {% for message in messages %}
                                            <li class="{{ message.tags }}">{{ message }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                            <div class="x_content">


                                <!-- Smart Wizard -->

                                <form class="form-horizontal" method="POST" action="">
                                    {% csrf_token %}
                                    {% for entry in projects %}
                                        <div class="row spacer">
                                            <div class="form-group">
                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                       for="first-name">Project
                                                    Name
                                                </label>
                                                <div class="col-md-6 col-sm-6 col-xs-12">
                                                    <input type="text" name="project" value="{{ entry.projectTitle }}"
                                                           required="required" class="form-control col-md-7 col-xs-12"
                                                           readonly/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                       for="first-name">Project
                                                    Date
                                                </label>
                                                <div class="col-md-6 col-sm-6 col-xs-12">
                                                    <input type="text" name="project"
                                                           value="{{ entry.startDate }} - {{ entry.endDate }}"
                                                           required="required" class="form-control col-md-7 col-xs-12"
                                                           readonly/>
                                                </div>
                                            </div>
                                            <input class="form-control col-md-7 col-xs-12" id="startDate"
                                                   type="text" value="{{ entry.startDate }}"
                                                   style="display: none;">
                                            <input class="form-control col-md-7 col-xs-12" id="endDate"
                                                   type="text" value="{{ entry.endDate }}"
                                                   style="display: none;">


                                        </div>
                                    {% endfor %}



                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Milestone
                                                Name<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                                <input class="form-control" name="milestoneName">
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Start
                                                Date<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                               <input class="form-control" type="date" name="milestonestartDate">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row form-row spacer">
                                        <div class="form-group input-group col-md-12">
                                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Due
                                                Date<span id="taskcounter"></span>
                                            </label>
                                            <div class="col-md-6 col-sm-6 col-xs-12">

                                               <input class="form-control" type="date" name="milestoneendDate">
                                            </div>
                                        </div>

                                    </div>


                                    <div class="row spacer">
                                        <div class="form-group">
                                            <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                                                <button type="submit" class="btn btn-success" style="margin-left: 140px;">Add
                                                    Milestone
                                                </button>

                                            </div>
                                        </div>
                                    </div>
                                </form>
                            <form method="POST">
                                    {% csrf_token %}
                                    {% for entry in projects %}
                                        <input style="display: none" name="dontload" value="1">
                                        <input name="projectID" style="display: none"
                                               value="{{ entry.principalInvestigator_id }}">
                                        <button type="submit" class="btn btn-primary"
                                                style="margin-left: 420px; margin-top: 5px;">Add Members
                                        </button>
                                    {% endfor %}
                                </form>
                                <div class="ln_solid"></div>
                                {% if all_formset %}

                                    <table id="datatable" class="table table-striped table-bordered">
                                        <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Milestone Name</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th></th>
                                            <th></th>

                                        </tr>
                                        </thead>
                                        {% for milestone in all_formset %}
                                            <tbody>
                                            <tr>
                                                <td>{{ forloop.counter }}</td>
                                                <td>{{ milestone.milestoneName }}</td>
                                                <td>{{ milestone.milestonestartDate }}</td>
                                                <td>{{ milestone.milestoneendDate }}</td>
                                                <td>
                                                    <button type="button" class="btn btn-primary btn-sm"
                                                            style="margin-left: 15px; margin-right: -30px;"
                                                            data-toggle="modal" data-target="#edit-{{ milestone.pk }}">
                                                        Edit
                                                    </button>
                                                </td>
                                                <td>
                                                    <button type="button" class="btn btn-danger btn-sm"
                                                            style="margin-left: 15px; margin-right: -30px;"
                                                            data-toggle="modal"
                                                            data-target="#delete-{{ milestone.pk }}">
                                                        Delete
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                            <div class="modal fade bs-example-modal-sm-resolution"
                                                 style="width:600px; margin-left: 300px; margin-top: 20px;"
                                                 id="delete-{{ milestone.pk }}" tabindex="-1" role="dialog"
                                                 aria-hidden="true">

                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal"
                                                                aria-label="Close"><span aria-hidden="true">×</span>
                                                        </button>
                                                        <h4 class="modal-title" id="myModalLabel2">Delete Milestone</h4>

                                                    </div>
                                                    <form method="POST">
                                                        {% csrf_token %}
                                                        <div class="modal-body" style="height: 100px;">
                                                            <div class="form-group" style="display: none;">
                                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                       for="first-name">Milestone Name<span
                                                                        class="required"></span>
                                                                </label>
                                                                <div class="col-md-9 col-sm-9 col-xs-12">
                                                                    <input type="text" name="milestoneID"
                                                                           value="{{ milestone.id }}"
                                                                           class="form-control col-md-7 col-xs-12">
                                                                </div>
                                                            </div>
                                                            <div class="form-group" style="display: none;">
                                                                <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                       for="first-name">Milestone Name<span
                                                                        class="required"></span>
                                                                </label>
                                                                <div class="col-md-9 col-sm-9 col-xs-12">
                                                                    <input type="text" name="milestoneUpdate"
                                                                           value="Delete"
                                                                           class="form-control col-md-7 col-xs-12">
                                                                </div>
                                                            </div>

                                                            <div style="font-size: 15px;"> Are you sure you want to
                                                                delete
                                                                the milestone "{{ milestone.milestoneName }}"?
                                                            </div>

                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="submit" class="btn btn-primary">Yes</button>
                                                            <button type="button" class="btn btn-default"
                                                                    data-dismiss="modal">No
                                                            </button>

                                                        </div>

                                                    </form>

                                                </div>
                                            </div>
                                            <div class="modal fade bs-example-modal-sm-resolution"
                                                 style="width:600px; height: auto; margin-left: 300px; margin-top: 20px;"
                                                 id="edit-{{ milestone.pk }}" tabindex="-1" role="dialog"
                                                 aria-hidden="true">

                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal"
                                                                aria-label="Close"><span aria-hidden="true">×</span>
                                                        </button>
                                                        <h4 class="modal-title" id="myModalLabel2">Update Milestone</h4>

                                                    </div>
                                                    <form method="POST">
                                                        {% csrf_token %}
                                                        <div class="modal-body" style="height: 150px;">
                                                            <div class="row form-row spacer">
                                                                <div class="form-group" style="display: none;">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">Milestone Name<span
                                                                            class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="milestoneID"
                                                                               value="{{ milestone.id }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group" style="display: none;">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">Milestone Name<span
                                                                            class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="milestoneUpdate"
                                                                               value="Update"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">Milestone
                                                                        Name<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" style="margin-top: 10px;"
                                                                               name="oldmilestoneName"
                                                                               value="{{ milestone.milestoneName }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">Start
                                                                        Date<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" style="margin-top: 10px;"
                                                                               name="oldmilestonestartDate"
                                                                               value="{{ milestone.milestonestartDate }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">
                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name" style="margin-top: 10px;">End
                                                                        Date<span
                                                                                class="required"></span>
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        <input type="text" name="oldmilestoneendDate"
                                                                               style="margin-top: 10px;"
                                                                               value="{{ milestone.milestoneendDate }}"
                                                                               class="form-control col-md-7 col-xs-12">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">

                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           style="margin-top: 30px;" for="first-name">New
                                                                        Milestone Name
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12"
                                                                         style="margin-top: 30px;">
                                                                        {{ updateform.newmilestoneName }}
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">

                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12"
                                                                           for="first-name">New
                                                                        Milestone Start Date
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        {{ updateform.newmilestonestartDate }}
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="row form-row spacer">
                                                                <div class="form-group">

                                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">New
                                                                        Milestone End Date
                                                                    </label>
                                                                    <div class="col-md-9 col-sm-9 col-xs-12">
                                                                        {{ updateform.newmilestoneendDate }}
                                                                    </div>

                                                                </div>


                                                            </div>
                                                        </div>

                                                        <button type="button" class="btn btn-default"
                                                                data-dismiss="modal"
                                                                style="margin-top: 20px; margin-left: 420px; margin-bottom: 20px;">
                                                            Close
                                                        </button>
                                                        <input type="submit" class="btn btn-primary"
                                                               style="margin-top: 20px; margin-bottom: 20px;">

                                                    </form>

                                                </div>
                                            </div>
                                        {% endfor %}
                                    </table>

                                {% endif %}


                            </div>
                        </div>

                    </div>
                </div>
            </div></div>
        {% endif %}
    {% endfor %}



{% endblock %}
{% block script %}

    <script>function redirect() {
        window.location ={% url 'addmembers' %};
    }</script>
    <script>
        function yesNoCheck() {
            if (document.getElementById('milestoneUpdate').value == 'Update') {
                document.getElementById("newmilestoneName").style.display = "block";
            } else {
                document.getElementById("newmilestoneName").style.display = "none";
            }
        }
    </script>

    <script type='text/javascript'>

        function updateElementIndex(el, prefix, ndx) {
            var id_regex = new RegExp('(' + prefix + '-\\d+)');
            var replacement = prefix + '-' + ndx;
            if ($(el).attr("for")) $(el).attr("for", $(el).attr("for").replace(id_regex, replacement));
            if (el.id) el.id = el.id.replace(id_regex, replacement);
            if (el.taskName) el.taskName = el.taskName.replace(id_regex, replacement);
            if (el.assignedTo) el.assignedTo = el.assignedTo.replace(id_regex, replacement);
            if (el.milestonestartDate) el.milestonestartDate = el.milestonestartDate.replace(id_regex, replacement);
            if (el.milestoneendDate) el.milestoneendDate = el.milestoneendDate.replace(id_regex, replacement);
        }

        function cloneMore(selector, prefix,) {
            var newElement = $(selector).clone(true);
            var total = $('#id_' + prefix + '-TOTAL_FORMS').val();
            newElement.find(':input').each(function () {
                var taskName = $(this).attr('taskName');
                var assignedTo = $(this).attr('assignedTo');
                var milestonestartDate = $(this).attr('milestonestartDate');
                var milestoneendDate = $(this).attr('milestoneendDate');

                if (taskName) {
                    taskName = $(this).attr('taskName').replace('-' + (total - 1) + '-', '-' + total + '-');
                    id = 'id_' + taskName;
                    $(this).attr({'taskName': taskName, 'id': id}).val('').removeAttr('checked');
                } else if (assignedTo) {
                    assignedTo = $(this).attr('assignedTo').replace('-' + (total - 1) + '-', '-' + total + '-');
                    id = 'id_' + assignedTo;
                    $(this).attr({'assignedTo': assignedTo, 'id': id}).val('').removeAttr('checked');
                } else if (milestonestartDate) {
                    milestonestartDate = $(this).attr('milestonestartDate').replace('-' + (total - 1) + '-', '-' + total + '-');
                    id = 'id_' + milestonestartDate;
                    $(this).attr({'milestonestartDate': milestonestartDate, 'id': id}).val('').removeAttr('checked');
                } else if (milestoneendDate) {
                    milestoneendDate = $(this).attr('milestoneendDate').replace('-' + (total - 1) + '-', '-' + total + '-');
                    id = 'id_' + milestoneendDate;
                    $(this).attr({'milestoneendDate': milestoneendDate, 'id': id}).val('').removeAttr('checked');
                }
            });
            alert(total)
            total++;
            $('#id_' + prefix + '-TOTAL_FORMS')
            $(selector).after(newElement);
            var conditionRow = $('.form-row:not(:last)');
            conditionRow.find('.btn.add-form-row')
                .removeClass('btn-success').addClass('btn-danger')
                .removeClass('add-form-row').addClass('remove-form-row')
                .html('<span class="glyphicon glyphicon-minus" aria-hidden="true"></span>');
            return false;
        }

        function deleteForm(prefix, btn) {
            var total = parseInt($('#id_' + prefix + '-TOTAL_FORMS').val());
            if (total > 1) {
                btn.closest('.form-row').remove();
                var forms = $('.form-row');
                $('#id_' + prefix + '-TOTAL_FORMS').val(forms.length);
                for (var i = 0, formCount = forms.length; i < formCount; i++) {
                    $(forms.get(i)).find(':input').each(function () {
                        updateElementIndex(this, prefix, i);
                    });
                }
            }
            return false;
        }

        $(document).on('click', '.add-form-row', function (e) {
            e.preventDefault();
            cloneMore('.form-row', 'form');
            return false;
        });
        $(document).on('click', '.remove-form-row', function (e) {
            e.preventDefault();
            deleteForm('form', $(this));
            return false;
        });
    </script>

{% endblock %}